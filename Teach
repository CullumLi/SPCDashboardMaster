graph TD
    %% 定義樣式
    classDef human fill:#fff3e0,stroke:#ff9800,stroke-width:2px,color:#000000;
    classDef ai fill:#e3f2fd,stroke:#2196f3,stroke-width:2px,color:#000000;
    classDef system fill:#f5f5f5,stroke:#9e9e9e,stroke-width:2px,stroke-dasharray: 5 5,color:#000000;
    classDef decision fill:#fff9c4,stroke:#fbc02d,stroke-width:2px,color:#000000;

    subgraph "第一階段：需求定義與提問 (Human Lead)"
        A[💡 發現痛點 & 定義需求]:::human --> B(拆解步驟 & 確認輸入/輸出):::human
        B --> C{撰寫黃金 Prompt指令}:::human
    end

    C -->|清晰的自然語言指令| D

    subgraph "第二階段：AI 生成與實作 (AI Assist)"
        D[🤖 ChatGPT 接收並處理]:::ai
        D --> E[生成標準化 VBA 程式碼]:::ai
        E -->|複製程式碼| F
    end

    subgraph "第三階段：環境執行與驗證 (Execution)"
        F[開啟 Excel VBE (Alt+F11)<br>插入新模組]:::system
        F --> G[貼上代碼並存檔]:::system
        G --> H[執行巨集 (Run / Alt+F8)]:::system
        H --> I{菱形檢核點：<br>結果是否完美符合預期？}:::decision
    end

    %% 迴圈路徑：除錯與優化
    I -- "❌ 否 (報錯或結果錯誤)" --> J[複製錯誤訊息 / 描述錯誤現象]:::human
    J -->|反饋給 AI：請修正...| D
    
    %% 成功路徑
    I -- "✅ 是 (完美運行)" --> K[🔒 另存為 .xlsm 啟用巨集活頁簿]:::system

    subgraph "第四階段：智能化成果 (Value)"
        K --> L[🚀 整合至日常工作流<br>(建立按鈕或排程)]:::human
        L --> M(🏆 實現辦公自動化與智能化):::human
    end

    %% 註解連線
    style C stroke-width:4px
    style I stroke-width:4px

